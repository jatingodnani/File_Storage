{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { StorageKey } from '@airgap/beacon-types';\nimport { StorageManager } from './StorageManager';\nimport { PermissionValidator } from './PermissionValidator';\n/**\n * @internalapi\n *\n * The PermissionManager provides CRUD functionality for permission entities and persists them to the provided storage.\n */\nexport class PermissionManager {\n  constructor(storage) {\n    this.storageManager = new StorageManager(storage, StorageKey.PERMISSION_LIST);\n  }\n  getPermissions() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storageManager.getAll();\n    });\n  }\n  getPermission(accountIdentifier) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storageManager.getOne(permission => permission.accountIdentifier === accountIdentifier);\n    });\n  }\n  addPermission(permissionInfo) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storageManager.addOne(permissionInfo, permission => permission.accountIdentifier === permissionInfo.accountIdentifier);\n    });\n  }\n  removePermission(accountIdentifier) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storageManager.remove(permissionInfo => permissionInfo.accountIdentifier === accountIdentifier);\n    });\n  }\n  removePermissions(accountIdentifiers) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storageManager.remove(permission => accountIdentifiers.includes(permission.accountIdentifier));\n    });\n  }\n  removeAllPermissions() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storageManager.removeAll();\n    });\n  }\n  hasPermission(message) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return PermissionValidator.hasPermission(message, this.getPermission.bind(this), this.getPermissions.bind(this));\n    });\n  }\n}","map":{"version":3,"names":["StorageKey","StorageManager","PermissionValidator","PermissionManager","constructor","storage","storageManager","PERMISSION_LIST","getPermissions","getAll","getPermission","accountIdentifier","getOne","permission","addPermission","permissionInfo","addOne","removePermission","remove","removePermissions","accountIdentifiers","includes","removeAllPermissions","removeAll","hasPermission","message","bind"],"sources":["../../../src/managers/PermissionManager.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAAiCA,UAAU,QAAwB,sBAAsB;AACzF,SAASC,cAAc,QAAQ,kBAAkB;AACjD,SAASC,mBAAmB,QAAQ,uBAAuB;AAE3D;;;;;AAKA,OAAM,MAAOC,iBAAiB;EAG5BC,YAAYC,OAAgB;IAC1B,IAAI,CAACC,cAAc,GAAG,IAAIL,cAAc,CAACI,OAAO,EAAEL,UAAU,CAACO,eAAe,CAAC;EAC/E;EAEaC,cAAcA,CAAA;;MACzB,OAAO,IAAI,CAACF,cAAc,CAACG,MAAM,EAAE;IACrC,CAAC;;EAEYC,aAAaA,CAACC,iBAAyB;;MAClD,OAAO,IAAI,CAACL,cAAc,CAACM,MAAM,CAC9BC,UAA0B,IAAKA,UAAU,CAACF,iBAAiB,KAAKA,iBAAiB,CACnF;IACH,CAAC;;EAEYG,aAAaA,CAACC,cAA8B;;MACvD,OAAO,IAAI,CAACT,cAAc,CAACU,MAAM,CAC/BD,cAAc,EACbF,UAA0B,IACzBA,UAAU,CAACF,iBAAiB,KAAKI,cAAc,CAACJ,iBAAiB,CACpE;IACH,CAAC;;EAEYM,gBAAgBA,CAACN,iBAAyB;;MACrD,OAAO,IAAI,CAACL,cAAc,CAACY,MAAM,CAC9BH,cAA8B,IAAKA,cAAc,CAACJ,iBAAiB,KAAKA,iBAAiB,CAC3F;IACH,CAAC;;EAEYQ,iBAAiBA,CAACC,kBAA4B;;MACzD,OAAO,IAAI,CAACd,cAAc,CAACY,MAAM,CAAEL,UAA0B,IAC3DO,kBAAkB,CAACC,QAAQ,CAACR,UAAU,CAACF,iBAAiB,CAAC,CAC1D;IACH,CAAC;;EAEYW,oBAAoBA,CAAA;;MAC/B,OAAO,IAAI,CAAChB,cAAc,CAACiB,SAAS,EAAE;IACxC,CAAC;;EAEYC,aAAaA,CAACC,OAAsB;;MAC/C,OAAOvB,mBAAmB,CAACsB,aAAa,CACtCC,OAAO,EACP,IAAI,CAACf,aAAa,CAACgB,IAAI,CAAC,IAAI,CAAC,EAC7B,IAAI,CAAClB,cAAc,CAACkB,IAAI,CAAC,IAAI,CAAC,CAC/B;IACH,CAAC"},"metadata":{},"sourceType":"module"}