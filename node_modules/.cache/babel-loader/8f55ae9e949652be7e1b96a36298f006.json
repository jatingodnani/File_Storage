{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n/* eslint-disable prefer-arrow/prefer-arrow-functions */\nfunction fixArrayType(array) {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return array;\n}\n/* eslint-enable prefer-arrow/prefer-arrow-functions */\n/**\n * @internalapi\n *\n * The StorageManager provides CRUD functionality for specific entities and persists them to the provided storage.\n */\nexport class StorageManager {\n  constructor(storage, storageKey) {\n    this.storage = storage;\n    this.storageKey = storageKey;\n  }\n  getAll() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storage.get(this.storageKey);\n    });\n  }\n  getOne(predicate) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const entities = yield this.storage.get(this.storageKey);\n      return fixArrayType(entities).find(predicate);\n    });\n  }\n  addOne(element, predicate) {\n    let overwrite = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    return __awaiter(this, void 0, void 0, function* () {\n      const entities = yield this.storage.get(this.storageKey);\n      if (!fixArrayType(entities).some(predicate)) {\n        fixArrayType(entities).push(element);\n      } else if (overwrite) {\n        for (let i = 0; i < entities.length; i++) {\n          if (predicate(fixArrayType(entities)[i])) {\n            entities[i] = element;\n          }\n        }\n      }\n      return this.storage.set(this.storageKey, entities);\n    });\n  }\n  remove(predicate) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const entities = yield this.storage.get(this.storageKey);\n      const filteredEntities = fixArrayType(entities).filter(entity => !predicate(entity));\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      return this.storage.set(this.storageKey, filteredEntities);\n    });\n  }\n  removeAll() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return this.storage.delete(this.storageKey);\n    });\n  }\n}","map":{"version":3,"names":["fixArrayType","array","StorageManager","constructor","storage","storageKey","getAll","get","getOne","predicate","entities","find","addOne","element","overwrite","arguments","length","undefined","some","push","i","set","remove","filteredEntities","filter","entity","removeAll","delete"],"sources":["../../../src/managers/StorageManager.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA;AACA,SAASA,YAAYA,CAAIC,KAAQ;EAC/B;EACA,OAAOA,KAAY;AACrB;AACA;AAEA;;;;;AAKA,OAAM,MAAOC,cAAc;EAazBC,YAAYC,OAAgB,EAAEC,UAAa;IACzC,IAAI,CAACD,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACC,UAAU,GAAGA,UAAU;EAC9B;EAEaC,MAAMA,CAAA;;MACjB,OAAO,IAAI,CAACF,OAAO,CAACG,GAAG,CAAC,IAAI,CAACF,UAAU,CAAC;IAC1C,CAAC;;EAEYG,MAAMA,CACjBC,SAAmE;;MAEnE,MAAMC,QAAQ,GAAG,MAAM,IAAI,CAACN,OAAO,CAACG,GAAG,CAAC,IAAI,CAACF,UAAU,CAAC;MAExD,OAAOL,YAAY,CAACU,QAAQ,CAAC,CAACC,IAAI,CAACF,SAAS,CAAC;IAC/C,CAAC;;EAEYG,MAAMA,CACjBC,OAA2C,EAC3CJ,SAAmE,EAC1C;IAAA,IAAzBK,SAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAqB,IAAI;;MAEzB,MAAML,QAAQ,GAAG,MAAM,IAAI,CAACN,OAAO,CAACG,GAAG,CAAC,IAAI,CAACF,UAAU,CAAC;MAExD,IAAI,CAACL,YAAY,CAACU,QAAQ,CAAC,CAACQ,IAAI,CAACT,SAAS,CAAC,EAAE;QAC3CT,YAAY,CAACU,QAAQ,CAAC,CAACS,IAAI,CAACN,OAAO,CAAC;OACrC,MAAM,IAAIC,SAAS,EAAE;QACpB,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGV,QAAQ,CAACM,MAAM,EAAEI,CAAC,EAAE,EAAE;UACxC,IAAIX,SAAS,CAACT,YAAY,CAACU,QAAQ,CAAC,CAACU,CAAC,CAAC,CAAC,EAAE;YACxCV,QAAQ,CAACU,CAAC,CAAC,GAAGP,OAAO;;;;MAK3B,OAAO,IAAI,CAACT,OAAO,CAACiB,GAAG,CAAC,IAAI,CAAChB,UAAU,EAAEK,QAAQ,CAAC;IACpD,CAAC;;EAEYY,MAAMA,CACjBb,SAAmE;;MAEnE,MAAMC,QAAQ,GAAG,MAAM,IAAI,CAACN,OAAO,CAACG,GAAG,CAAC,IAAI,CAACF,UAAU,CAAC;MAExD,MAAMkB,gBAAgB,GAAGvB,YAAY,CAACU,QAAQ,CAAC,CAACc,MAAM,CAAEC,MAAM,IAAK,CAAChB,SAAS,CAACgB,MAAM,CAAC,CAAC;MAEtF;MACA,OAAO,IAAI,CAACrB,OAAO,CAACiB,GAAG,CAAC,IAAI,CAAChB,UAAU,EAAEkB,gBAAuB,CAAC;IACnE,CAAC;;EAEYG,SAASA,CAAA;;MACpB,OAAO,IAAI,CAACtB,OAAO,CAACuB,MAAM,CAAC,IAAI,CAACtB,UAAU,CAAC;IAC7C,CAAC"},"metadata":{},"sourceType":"module"}