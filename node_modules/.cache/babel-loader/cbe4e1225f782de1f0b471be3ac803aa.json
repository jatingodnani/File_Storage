{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { defaultValues } from '@airgap/beacon-types';\n/**\n * @internalapi\n *\n * A storage that can be used in the browser\n */\nexport class LocalStorage {\n  constructor(prefix) {\n    this.prefix = prefix;\n  }\n  static isSupported() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return Promise.resolve(Boolean(typeof window !== 'undefined') && Boolean(window.localStorage));\n    });\n  }\n  get(key) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const value = localStorage.getItem(this.getPrefixedKey(key));\n      if (!value) {\n        if (typeof defaultValues[key] === 'object') {\n          return JSON.parse(JSON.stringify(defaultValues[key]));\n        } else {\n          return defaultValues[key];\n        }\n      } else {\n        try {\n          return JSON.parse(value);\n        } catch (jsonParseError) {\n          return value; // TODO: Validate storage\n        }\n      }\n    });\n  }\n\n  set(key, value) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (typeof value === 'string') {\n        return localStorage.setItem(this.getPrefixedKey(key), value);\n      } else {\n        return localStorage.setItem(this.getPrefixedKey(key), JSON.stringify(value));\n      }\n    });\n  }\n  delete(key) {\n    return __awaiter(this, void 0, void 0, function* () {\n      return Promise.resolve(localStorage.removeItem(this.getPrefixedKey(key)));\n    });\n  }\n  getPrefixedKey(key) {\n    return this.prefix ? `${this.prefix}-${key}` : key;\n  }\n}","map":{"version":3,"names":["defaultValues","LocalStorage","constructor","prefix","isSupported","Promise","resolve","Boolean","window","localStorage","get","key","value","getItem","getPrefixedKey","JSON","parse","stringify","jsonParseError","set","setItem","delete","removeItem"],"sources":["../../../src/storage/LocalStorage.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAAoDA,aAAa,QAAQ,sBAAsB;AAE/F;;;;;AAKA,OAAM,MAAOC,YAAY;EACvBC,YAA6BC,MAAe;IAAf,KAAAA,MAAM,GAANA,MAAM;EAAY;EACxC,OAAaC,WAAWA,CAAA;;MAC7B,OAAOC,OAAO,CAACC,OAAO,CAACC,OAAO,CAAC,OAAOC,MAAM,KAAK,WAAW,CAAC,IAAID,OAAO,CAACC,MAAM,CAACC,YAAY,CAAC,CAAC;IAChG,CAAC;;EAEYC,GAAGA,CAAuBC,GAAM;;MAC3C,MAAMC,KAAK,GAAGH,YAAY,CAACI,OAAO,CAAC,IAAI,CAACC,cAAc,CAACH,GAAG,CAAC,CAAC;MAC5D,IAAI,CAACC,KAAK,EAAE;QACV,IAAI,OAAOZ,aAAa,CAACW,GAAG,CAAC,KAAK,QAAQ,EAAE;UAC1C,OAAOI,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACjB,aAAa,CAACW,GAAG,CAAC,CAAC,CAAC;SACtD,MAAM;UACL,OAAOX,aAAa,CAACW,GAAG,CAAC;;OAE5B,MAAM;QACL,IAAI;UACF,OAAOI,IAAI,CAACC,KAAK,CAACJ,KAAK,CAAC;SACzB,CAAC,OAAOM,cAAc,EAAE;UACvB,OAAON,KAAgC,EAAC;;;IAG9C,CAAC;;;EAEYO,GAAGA,CAAuBR,GAAM,EAAEC,KAA8B;;MAC3E,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;QAC7B,OAAOH,YAAY,CAACW,OAAO,CAAC,IAAI,CAACN,cAAc,CAACH,GAAG,CAAC,EAAEC,KAAK,CAAC;OAC7D,MAAM;QACL,OAAOH,YAAY,CAACW,OAAO,CAAC,IAAI,CAACN,cAAc,CAACH,GAAG,CAAC,EAAEI,IAAI,CAACE,SAAS,CAACL,KAAK,CAAC,CAAC;;IAEhF,CAAC;;EAEYS,MAAMA,CAAuBV,GAAM;;MAC9C,OAAON,OAAO,CAACC,OAAO,CAACG,YAAY,CAACa,UAAU,CAAC,IAAI,CAACR,cAAc,CAACH,GAAG,CAAC,CAAC,CAAC;IAC3E,CAAC;;EAEOG,cAAcA,CAACH,GAAW;IAChC,OAAO,IAAI,CAACR,MAAM,GAAG,GAAG,IAAI,CAACA,MAAM,IAAIQ,GAAG,EAAE,GAAGA,GAAG;EACpD"},"metadata":{},"sourceType":"module"}